<div class="total">
  <div class="vote-block">
    <form class="upvote-block" action='/votes' method='post'>
      <input class='vote-image' type="image" src="/image/upvote.png">
      <input type='hidden' name='value' value=1 >
      <input type='hidden' name='votable_id' value=<%=params[:id]%>>
      <input type='hidden' name='votable_type' value=Question>
      <input type='hidden' name='question_id' value=<%=params[:id]%>>
    </form>
    <form class="downvote-block" action='/votes' method='post'>
      <input class='vote-image' type='image' src="/image/downvote.png">
      <input type='hidden' name='value' value=-1 >
      <input type='hidden' name='votable_id' value=<%=params[:id]%>>
      <input type='hidden' name='votable_type' value=Question>
      <input type='hidden' name='question_id' value=<%=params[:id]%>>
    </form>
  </div>
  <div class="question-block">
    <div class="sum-block"><%= @question.votes.reduce(0) { |sum, vote| sum + vote.value } %></div>
  <h3><%= @question.title %></h3>
  </div>
  <p><%= @question.content %></p>
  <h6><%= @question.user.username %></h6>
</div>

<h2>Comments</h2>
<div class="total">
<ul>
  <% @question.comments.each do |comment| %>
    <li>
       <div class="vote-block">
        <form class="upvote-block" action='/votes' method='post'>
          <input class='vote-image' type="image" src="/image/upvote.png">
          <input type='hidden' name='value' value=1 >
          <input type='hidden' name='votable_id' value=<%=comment.id%>>
          <input type='hidden' name='votable_type' value=Comment>
          <input type='hidden' name='question_id' value=<%= @question.id%>>

        </form>
        <form class="downvote-block" action='/votes' method='post'>
          <input class='vote-image' type='image' src="/image/downvote.png">
          <input type='hidden' name='value' value=-1 >
          <input type='hidden' name='votable_id' value=<%=comment.id%>>
          <input type='hidden' name='votable_type' value=Comment>
          <input type='hidden' name='question_id' value=<%= @question.id%>>
        </form>
      </div>
      <div class="sum-block"><%= comment.votes.reduce(0) { |sum, vote| sum + vote.value } %></div>
      <p><%= comment.content %></p>
      <h6><%= comment.user.username %></h6>
    </li>
  <% end %>
</ul>
</div>
<a href="/questions/<%=@question.id%>/comments/new">Add a comment</a>

<br>
<br>

<h2>Answers</h2>
<br><br>
<a class='new_answer_form' href="/questions/<%=@question.id%>/answers/new">Answer this question!</a>

<ul id='create_new_answer'>
  <% @question.answers.each do |answer| %>
    <li>

      <form class="best_answer" action='/answers/best' method='post'>
        <input class='best_answer_button' type="image" src="/image/best_answer.png">
        <input type="hidden" name="answer_id" value=<%= answer.id %>>
      </form>

      <div class="vote-block">
        <form class="upvote-block" action='/votes' method='post'>
          <input class='vote-image' type="image" src="/image/upvote.png">
          <input type='hidden' name='value' value=1 >
          <input type='hidden' name='votable_id' value=<%=answer.id%>>
          <input type='hidden' name='votable_type' value=Answer>
          <input type='hidden' name='question_id' value=<%= @question.id%>>

        </form>
        <form class="downvote-block" action='/votes' method='post'>
          <input class='vote-image' type='image' src="/image/downvote.png">
          <input type='hidden' name='value' value=-1 >
          <input type='hidden' name='votable_id' value=<%=answer.id%>>
          <input type='hidden' name='votable_type' value=Answer>
          <input type='hidden' name='question_id' value=<%= @question.id%>>
        </form>
      </div>
      <div class="sum-block"><%= answer.votes.reduce(0) { |sum, vote| sum + vote.value } %></div>
      <p><%= answer.content %></p>
      <h6><%= answer.user.username %></h6>
      <ul class='total'>
        <% answer.comments.each do |comment| %>
          <li>
            <div class="vote-block">
              <form class="upvote-block" action='/votes' method='post'>
                <input class='vote-image' type="image" src="/image/upvote.png">
                <input type='hidden' name='value' value=1 >
                <input type='hidden' name='votable_id' value=<%=comment.id%>>
                <input type='hidden' name='votable_type' value=Comment>
                <input type='hidden' name='question_id' value=<%= @question.id%>>
              </form>
              <form class="downvote-block" action='/votes' method='post'>
                <input class='vote-image' type='image' src="/image/downvote.png">
                <input type='hidden' name='value' value=-1 >
                <input type='hidden' name='votable_id' value=<%=comment.id%>>
                <input type='hidden' name='votable_type' value=Comment>
                <input type='hidden' name='question_id' value=<%= @question.id%>>
              </form>
            </div>
            <div class="sum-block"><%= comment.votes.reduce(0) { |sum, vote| sum + vote.value } %></div>
            <p><%= comment.content %></p>
            <h6><%= comment.user.username %></h6>
          </li>
        <% end %>
      </ul>
    </li>
<a href="/answers/<%=answer.id%>/comments/new">Comment on this answer</a>
  <% end %>
</ul>

<br>
<br>

<a href="/questions/<%=@question.id%>/answers/new">Answer this question!</a>
